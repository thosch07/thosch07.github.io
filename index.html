<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Psychology Assessment - Schnitzlein Consulting</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7ZVV3LY8MS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-7ZVV3LY8MS');
    </script>
    
    <!-- Microsoft Clarity -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "rt0249zmhv");
    </script>
    
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 800px;
            width: 100%;
            text-align: center;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: 700;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.2em;
        }
        
        .question-container {
            display: none;
            text-align: left;
            margin-bottom: 30px;
        }
        
        .question {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            line-height: 1.4;
        }
        
        .options {
            display: grid;
            gap: 15px;
        }
        
        .option {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }
        
        .option:hover {
            background: #e9ecef;
            border-color: #667eea;
        }
        
        .option.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
            margin: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress {
            background: #e9ecef;
            border-radius: 10px;
            height: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-bar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        
        .results {
            display: none;
            text-align: center;
        }
        
        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            color: white;
            font-size: 2em;
            font-weight: bold;
        }
        
        .category {
            font-size: 1.5em;
            font-weight: 700;
            margin: 20px 0;
            color: #333;
        }
        
        .email-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid #e9ecef;
        }
        
        .email-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        
        .email-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .disclaimer {
            font-size: 0.9em;
            color: #666;
            margin-top: 20px;
            line-height: 1.4;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .question {
                font-size: 1.1em;
            }
            
            .option {
                padding: 12px 15px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Screen -->
        <div id="start-screen">
            <h1>Trading Psychology Assessment</h1>
            <p class="subtitle">Discover your emotional trading patterns and psychological weaknesses</p>
            <button class="btn" onclick="startAssessment()">Start Assessment</button>
            <p class="disclaimer">This assessment analyzes your trading psychology patterns. Results are for educational purposes and not financial advice.</p>
        </div>

        <!-- Question Screen -->
        <div id="question-screen" style="display: none;">
            <div class="progress">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div class="question-container" id="question-container">
                <div class="question" id="question-text"></div>
                <div class="options" id="options-container"></div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" id="next-btn" onclick="nextQuestion()" disabled>Next Question</button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="results">
            <h2>Your Assessment Results</h2>
            <div class="score-circle" id="score-circle"></div>
            <div class="category" id="category-result"></div>
            
            <div class="email-section">
                <h3>Get Your Personalized Trading Psychology Report</h3>
                <p>Enter your email to receive detailed insights and actionable recommendations:</p>
                <input type="email" class="email-input" id="email-input" placeholder="Enter your email address">
                <button class="btn" onclick="submitEmail()">Get Tips</button>
            </div>
        </div>
    </div>

    <script>
        // Assessment Questions
        var questions = [
            {
                question: "When you see a potential trade opportunity, how do you typically react?",
                options: [
                    "I carefully analyze the setup and wait for confirmation",
                    "I take some time to think but usually enter fairly quickly", 
                    "I often enter immediately when I see the pattern",
                    "I jump in right away - I don't want to miss out"
                ]
            },
            {
                question: "How do you handle losing trades?",
                options: [
                    "I review what went wrong and adjust my strategy",
                    "I feel frustrated but stick to my trading plan",
                    "I often increase position size to 'win back' losses",
                    "I immediately look for the next trade to recover quickly"
                ]
            },
            {
                question: "When you're in a winning trade, what's your usual approach?",
                options: [
                    "I stick to my predetermined exit strategy",
                    "I sometimes take profits early to secure gains",
                    "I often hold too long hoping for bigger profits",
                    "I frequently add to winning positions impulsively"
                ]
            },
            {
                question: "How do you feel during periods of consecutive losses?",
                options: [
                    "I remain calm and trust my long-term strategy",
                    "I feel concerned but continue following my plan",
                    "I start doubting my strategy and consider major changes",
                    "I become very stressed and often stop trading temporarily"
                ]
            },
            {
                question: "What's your approach to position sizing?",
                options: [
                    "I always use calculated position sizes based on risk management",
                    "I usually stick to standard sizes but occasionally vary them",
                    "I often trade larger when I'm confident about a setup",
                    "I frequently change position sizes based on recent results"
                ]
            },
            {
                question: "How do you handle high-volatility market conditions?",
                options: [
                    "I reduce position sizes and stick to my proven strategies",
                    "I trade more cautiously but continue with my approach",
                    "I sometimes take advantage but often get caught off guard",
                    "I either avoid trading completely or take excessive risks"
                ]
            },
            {
                question: "When you have a strong conviction about a trade, how do you proceed?",
                options: [
                    "I still follow my normal risk management rules",
                    "I might take a slightly larger position but stay disciplined",
                    "I often increase my position size significantly",
                    "I sometimes risk much more than usual"
                ]
            },
            {
                question: "How do you typically feel after a trading session?",
                options: [
                    "Satisfied with following my process regardless of outcome",
                    "Generally content but sometimes second-guess decisions",
                    "Often stressed about missed opportunities or poor timing",
                    "Frequently emotional - either very happy or very frustrated"
                ]
            }
        ];

        // Global variables
        var currentQuestion = 0;
        var userAnswers = [];
        var totalScore = 0;
        var startTime = Date.now();
        var aiDatabase = []; // In-memory storage instead of localStorage

        // Start Assessment
        function startAssessment() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('question-screen').style.display = 'block';
            
            // Track start in analytics
            gtag('event', 'assessment_started', {
                'event_category': 'engagement',
                'event_label': 'trading_psychology_assessment'
            });
            
            showQuestion();
        }

        // Show Question
        function showQuestion() {
            if (currentQuestion < questions.length) {
                document.getElementById('question-text').textContent = questions[currentQuestion].question;
                
                var optionsContainer = document.getElementById('options-container');
                optionsContainer.innerHTML = '';
                
                questions[currentQuestion].options.forEach(function(option, index) {
                    var optionDiv = document.createElement('div');
                    optionDiv.className = 'option';
                    optionDiv.textContent = option;
                    optionDiv.onclick = function() { selectOption(index); };
                    optionsContainer.appendChild(optionDiv);
                });
                
                updateProgress();
                document.getElementById('next-btn').disabled = true;
            } else {
                calculateResults();
            }
        }

        // Select Option
        function selectOption(index) {
            var options = document.querySelectorAll('.option');
            options.forEach(function(option) {
                option.classList.remove('selected');
            });
            options[index].classList.add('selected');
            
            userAnswers[currentQuestion] = index;
            document.getElementById('next-btn').disabled = false;
        }

        // Next Question
        function nextQuestion() {
            currentQuestion++;
            showQuestion();
        }

        // Update Progress
        function updateProgress() {
            var progress = (currentQuestion / questions.length) * 100;
            document.getElementById('progress-bar').style.width = progress + '%';
        }

        // Calculate Results
        function calculateResults() {
            userAnswers.forEach(function(answer) {
                totalScore += (answer + 1) * 10;
            });

            var category = getCategory(totalScore);
            var completionTime = Math.round((Date.now() - startTime) / 1000);

            // Store in AI Database (in-memory only)
            var sessionData = {
                timestamp: new Date().toISOString(),
                answers: userAnswers,
                totalScore: totalScore,
                category: category,
                completionTime: completionTime,
                emailProvided: false,
                pdfDownloaded: false
            };
            
            aiDatabase.push(sessionData);
            
            // Keep only last 50 sessions (memory management)
            if (aiDatabase.length > 50) {
                aiDatabase = aiDatabase.slice(-50);
            }

            showResults(totalScore, category);
        }

        // Get Category
        function getCategory(score) {
            if (score >= 280) return "CHAMPION TRADER";
            if (score >= 200) return "SOLID TRADER";
            if (score >= 120) return "DEVELOPING TRADER";
            return "VULNERABLE TRADER";
        }

        // Show Results
        function showResults(score, category) {
            document.getElementById('question-screen').style.display = 'none';
            document.getElementById('results-screen').style.display = 'block';
            
            document.getElementById('score-circle').textContent = score;
            document.getElementById('category-result').textContent = category;
            
            // Track completion in analytics
            gtag('event', 'assessment_completed', {
                'event_category': 'engagement',
                'event_label': 'trading_psychology_assessment',
                'value': score
            });
        }

        // Submit Email
        function submitEmail() {
            var email = document.getElementById('email-input').value;
            if (!email || !email.includes('@')) {
                alert('Please enter a valid email address');
                return;
            }
            
            // Track email capture
            gtag('event', 'email_captured', {
                'event_category': 'conversion',
                'event_label': 'trading_psychology_assessment'
            });
            
            // Update AI Database (in-memory)
            if (aiDatabase.length > 0) {
                aiDatabase[aiDatabase.length - 1].emailProvided = true;
                aiDatabase[aiDatabase.length - 1].email = email;
            }
            
            // Generate and download PDF
            generatePersonalizedReport();
            
            alert('Your personalized report is downloading now! Check your downloads folder.');
        }

        // Generate PDF Report
        function generatePersonalizedReport() {
            try {
                var { jsPDF } = window.jspdf;
                var doc = new jsPDF();
                
                // Helper function for section boxes
                function drawSectionBox(x, y, w, h, color) {
                    doc.setFillColor(color[0], color[1], color[2]);
                    doc.rect(x, y, w, h, 'F');
                }
                
                // Header
                doc.setFillColor(102, 126, 234);
                doc.rect(0, 0, 210, 50, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(24);
                doc.text('SCHNITZLEIN CONSULTING', 105, 20, { align: 'center' });
                doc.setFontSize(18);
                doc.text('Trading Psychology Report', 105, 30, { align: 'center' });
                doc.setFontSize(12);
                doc.text('Discover Your Emotional Trading Weaknesses', 105, 40, { align: 'center' });
                
                // Disclaimer
                var yPos = 60;
                doc.setFillColor(255, 248, 220);
                doc.setDrawColor(255, 193, 7);
                doc.setLineWidth(1);
                doc.rect(15, yPos, 180, 16, 'FD');
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(10);
                doc.setFont(undefined, 'bold');
                doc.text('IMPORTANT:', 20, yPos + 6);
                doc.setFont(undefined, 'normal');
                doc.text('Educational analysis of emotional trading patterns - Not financial advice', 45, yPos + 6);
                doc.text('For investment decisions, consult a licensed financial advisor', 20, yPos + 12);
                
                // Results Section
                yPos += 25;
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(16);
                doc.setFont(undefined, 'bold');
                doc.text('Your Assessment Results', 20, yPos);
                
                // Score Circle
                var category = getCategory(totalScore);
                var circleColor = [52, 152, 219]; // Default blue
                if (totalScore >= 280) circleColor = [46, 204, 113]; // Green for Champion
                else if (totalScore >= 200) circleColor = [52, 152, 219]; // Blue for Solid
                else if (totalScore >= 120) circleColor = [230, 126, 34]; // Orange for Developing
                else circleColor = [231, 76, 60]; // Red for Vulnerable
                
                doc.setFillColor(circleColor[0], circleColor[1], circleColor[2]);
                doc.circle(50, yPos + 25, 20, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(18);
                doc.setFont(undefined, 'bold');
                doc.text(totalScore.toString(), 50, yPos + 30, { align: 'center' });
                
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(14);
                doc.text('Overall Score: ' + totalScore + '/320', 80, yPos + 20);
                doc.text('Category: ' + category, 80, yPos + 30);
                
                // Strengths section
                yPos += 50;
                drawSectionBox(15, yPos, 180, 35, [230, 255, 230]); // Light green
                doc.setTextColor(0, 120, 0);
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('Your Strengths', 20, yPos + 10);
                
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                var strengthsText = getStrengthsText(category);
                var strengthsSentences = strengthsText.split('. ');
                var strengthsY = yPos + 20;
                for (var i = 0; i < strengthsSentences.length; i++) {
                    if (strengthsSentences[i].trim()) {
                        doc.text(strengthsSentences[i].trim() + (i < strengthsSentences.length - 1 ? '.' : ''), 20, strengthsY);
                        strengthsY += 5;
                    }
                }
                
                yPos = strengthsY + 8;
                
                // Improvements section
                drawSectionBox(15, yPos, 180, 35, [255, 235, 215]); // Light orange
                doc.setTextColor(180, 100, 0);
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('Key Areas for Improvement', 20, yPos + 10);
                
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                var improvementsText = getImprovementsText(category);
                var improvementsSentences = improvementsText.split('. ');
                var improvementsY = yPos + 20;
                for (var i = 0; i < improvementsSentences.length; i++) {
                    if (improvementsSentences[i].trim()) {
                        doc.text(improvementsSentences[i].trim() + (i < improvementsSentences.length - 1 ? '.' : ''), 20, improvementsY);
                        improvementsY += 5;
                    }
                }
                
                yPos = improvementsY + 10;
                
                // Action Plan section
                drawSectionBox(15, yPos, 180, 45, [230, 240, 255]); // Light blue
                doc.setTextColor(0, 100, 200);
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('Personalized Action Plan', 20, yPos + 10);
                
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                var actionPlan = getActionPlan(category);
                var actionY = yPos + 20;
                for (var i = 0; i < actionPlan.length; i++) {
                    doc.text((i + 1) + '. ' + actionPlan[i], 20, actionY);
                    actionY += 5;
                }
                
                yPos = actionY + 8;
                
                // Expert Insights Box
                doc.setDrawColor(0, 100, 200);
                doc.setLineWidth(1);
                doc.rect(15, yPos, 180, 30);
                doc.setFillColor(245, 248, 255);
                doc.rect(15, yPos, 180, 30, 'F');
                doc.setDrawColor(0, 100, 200);
                doc.rect(15, yPos, 180, 30);
                
                doc.setTextColor(0, 100, 200);
                doc.setFontSize(12);
                doc.setFont(undefined, 'bold');
                doc.text('Expert Insight', 20, yPos + 10);
                
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(9);
                doc.setFont(undefined, 'normal');
                doc.text('Based on 10+ years of market experience', 20, yPos + 16);
                doc.text('This analysis reflects common patterns seen in', 20, yPos + 21);
                doc.text('successful traders who have overcome similar', 20, yPos + 25);
                doc.text('psychological challenges.', 20, yPos + 29);
                
                // Footer
                doc.setTextColor(100, 100, 100);
                doc.setFontSize(8);
                doc.text('© 2025 Schnitzlein Consulting - Trading Psychology Assessment', 105, 285, { align: 'center' });
                
                // Update AI Database with PDF download (in-memory)
                if (aiDatabase.length > 0) {
                    aiDatabase[aiDatabase.length - 1].pdfDownloaded = true;
                }
                
                // Track PDF download
                gtag('event', 'pdf_downloaded', {
                    'event_category': 'conversion',
                    'event_label': 'trading_psychology_report',
                    'value': totalScore
                });
                
                // Download PDF
                doc.save('Trading_Psychology_Report_Schnitzlein_Consulting.pdf');
                
            } catch (error) {
                console.error('PDF generation failed:', error);
                alert('PDF generation failed. Please try again.');
            }
        }

        // Get category-specific content
        function getStrengthsText(category) {
            switch(category) {
                case "CHAMPION TRADER":
                    return "You demonstrate exceptional emotional control and mental resilience in your trading approach. Your discipline in following predetermined strategies is exemplary and serves as a model for other traders. You maintain composure even during challenging market conditions and have developed sophisticated psychological frameworks for decision-making.";
                case "SOLID TRADER":
                    return "You have developed good foundational trading psychology skills and generally maintain composure during normal market conditions. Your approach to risk management is sound and you typically stick to your predetermined strategies. You show good self-awareness about your emotional triggers.";
                case "DEVELOPING TRADER":
                    return "You recognize the importance of trading psychology and are working to improve your emotional control. You have periods of good discipline but still struggle with consistency. Your awareness of psychological factors puts you ahead of many traders at your level.";
                default:
                    return "You show motivation to improve your trading psychology, which is an excellent first step. You demonstrate self-awareness about emotional challenges in trading. Your willingness to take this assessment shows commitment to developing better trading habits.";
            }
        }

        function getImprovementsText(category) {
            switch(category) {
                case "CHAMPION TRADER":
                    return "Focus on advanced risk management techniques and consider mentoring other traders. Explore sophisticated position sizing strategies and develop systems for extremely volatile market conditions. Consider documenting your psychological frameworks for future reference.";
                case "SOLID TRADER":
                    return "Work on maintaining discipline during high-stress market conditions and consecutive losses. Develop better recovery strategies after emotional trading episodes. Consider implementing additional safeguards during volatile market periods.";
                case "DEVELOPING TRADER":
                    return "Establish more consistent pre-trading routines and develop better emotional awareness during trades. Work on reducing impulsive decision-making and strengthen your adherence to predetermined exit strategies. Focus on building systematic approaches to handle losses.";
                default:
                    return "Consider taking a break from active trading to focus on education and psychological preparation. Develop strict position sizing rules and practice with paper trading. Work with a mentor or trading psychology coach to address fundamental emotional challenges.";
            }
        }

        function getActionPlan(category) {
            switch(category) {
                case "CHAMPION TRADER":
                    return [
                        "Develop advanced position sizing algorithms",
                        "Create systems for extreme market volatility",
                        "Document your trading psychology framework",
                        "Consider mentoring developing traders",
                        "Explore institutional-level risk management"
                    ];
                case "SOLID TRADER":
                    return [
                        "Implement a daily pre-trading mental checklist",
                        "Set up automated stop-losses to reduce emotional decisions",
                        "Keep a detailed trading journal focusing on emotional states",
                        "Practice stress-reduction techniques",
                        "Review and adjust your trading plan quarterly"
                    ];
                case "DEVELOPING TRADER":
                    return [
                        "Start each day with a written trading plan",
                        "Use smaller position sizes while building discipline",
                        "Set maximum daily loss limits",
                        "Practice mindfulness techniques",
                        "Join a trading psychology support group"
                    ];
                default:
                    return [
                        "Take a 30-day break from live trading",
                        "Complete a comprehensive trading education course",
                        "Practice with paper trading for 3 months",
                        "Work with a trading psychology coach",
                        "Develop a strict risk management system"
                    ];
            }
        }

        // AI Database Console Functions
        function exportAssessmentData() {
            console.log('Assessment Data Export:', aiDatabase);
            return aiDatabase;
        }

        function getAIInsights() {
            if (aiDatabase.length === 0) {
                console.log('No assessment data available yet.');
                return;
            }

            var insights = {
                totalSessions: aiDatabase.length,
                averageScore: aiDatabase.reduce(function(sum, session) { return sum + session.totalScore; }, 0) / aiDatabase.length,
                categoryDistribution: {},
                averageCompletionTime: aiDatabase.reduce(function(sum, session) { return sum + session.completionTime; }, 0) / aiDatabase.length,
                emailCaptureRate: (aiDatabase.filter(function(session) { return session.emailProvided; }).length / aiDatabase.length) * 100,
                pdfDownloadRate: (aiDatabase.filter(function(session) { return session.pdfDownloaded; }).length / aiDatabase.length) * 100
            };

            aiDatabase.forEach(function(session) {
                insights.categoryDistribution[session.category] = (insights.categoryDistribution[session.category] || 0) + 1;
            });

            console.log('AI Insights:', insights);
            return insights;
        }

        function clearAllData() {
            aiDatabase = [];
            console.log('All assessment data cleared (session data reset)');
        }

        // Make functions available globally
        window.exportAssessmentData = exportAssessmentData;
        window.getAIInsights = getAIInsights;
        window.clearAllData = clearAllData;
    </script>
</body>
</html>
