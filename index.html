<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Psychology Assessment | Discover Your Emotional Trading Weaknesses</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7ZVV3LY8MS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-7ZVV3LY8MS');
    </script>
    
    <!-- Microsoft Clarity -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "rt0249zmhv");
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .intro {
            text-align: center;
            margin-bottom: 40px;
        }

        .intro h2 {
            color: #333;
            font-size: 1.8rem;
            margin-bottom: 15px;
        }

        .intro p {
            color: #666;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .start-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            font-weight: 600;
        }

        .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .question-container {
            display: none;
            text-align: center;
        }

        .question-container.active {
            display: block;
        }

        .question {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .answers {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
        }

        .answer {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .answer:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .answer.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .progress-bar {
            background: #e9ecef;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .results-container {
            display: none;
            text-align: center;
        }

        .results-container.active {
            display: block;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
        }

        .email-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin-top: 30px;
        }

        .email-section h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .email-form {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .email-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
        }

        .email-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .disclaimer {
            font-size: 0.85rem;
            color: #666;
            text-align: center;
            margin-top: 20px;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
            .content { padding: 20px; }
            .email-form { flex-direction: column; }
            .email-input { margin-bottom: 10px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Trading Psychology Assessment</h1>
            <p>Discover Your Emotional Trading Weaknesses</p>
        </div>

        <div class="content">
            <div class="intro" id="intro">
                <h2>Master Your Trading Psychology</h2>
                <p>Take our comprehensive assessment to identify emotional patterns that impact your trading performance. Get personalized insights and actionable strategies to improve your trading discipline.</p>
                
                <button class="start-button" onclick="startAssessment()">Start Assessment Now</button>
                
                <div class="disclaimer">
                    Educational analysis of emotional trading patterns - not financial advice. 
                    For investment decisions, consult a licensed financial advisor. 
                    By using this tool, you consent to analytics cookies for website improvement.
                </div>
            </div>

            <div class="question-container" id="question-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                
                <div class="question" id="question-text"></div>
                <div class="answers" id="answers"></div>
            </div>

            <div class="results-container" id="results-container">
                <h2>Your Trading Psychology Results</h2>
                <div class="score-circle" id="score-circle">0</div>
                <div id="results-content"></div>
                
                <div class="email-section">
                    <h3>Get Advanced Strategies and Insights</h3>
                    <p>Get advanced strategies and insights delivered to your inbox</p>
                    <div class="email-form">
                        <input type="email" class="email-input" id="email-input" placeholder="Enter your email address" required>
                        <button class="email-button" onclick="submitEmail()">Get Tips</button>
                    </div>
                    <div class="disclaimer">
                        By using this tool, you consent to anonymous analytics cookies (Google Analytics, Microsoft Clarity) for website improvement.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Assessment Data Collection
        var assessmentData = {
            sessionId: 'session_' + Date.now(),
            startTime: null,
            endTime: null,
            answers: {},
            totalScore: 0,
            category: '',
            completed: false,
            emailProvided: false,
            pdfDownloaded: false
        };

        // Trading Psychology Questions
        var questions = [
            {
                text: "When you experience a losing trade, what's your typical first reaction?",
                answers: [
                    "I immediately want to place a larger trade to recover losses",
                    "I feel frustrated but stick to my trading plan", 
                    "I analyze what went wrong before making another trade",
                    "I take a break from trading to clear my head"
                ]
            },
            {
                text: "How do you typically feel when you're in a winning position?",
                answers: [
                    "Excited and eager to increase my position size",
                    "Satisfied but focused on my exit strategy",
                    "Nervous about when to take profits",
                    "Confident in my analysis and plan"
                ]
            },
            {
                text: "What happens when the market moves against your analysis?",
                answers: [
                    "I hold on hoping it will turn around",
                    "I immediately exit according to my stop loss",
                    "I add to my position to average down",
                    "I feel stressed and have trouble deciding what to do"
                ]
            },
            {
                text: "How do you handle periods of consecutive losses?",
                answers: [
                    "I increase my position sizes to recover faster",
                    "I reduce my position sizes until I find my rhythm",
                    "I take a break from trading completely",
                    "I review and adjust my strategy"
                ]
            },
            {
                text: "When you see other traders making profits, you typically:",
                answers: [
                    "Feel like I'm missing out and rush into trades",
                    "Feel motivated to improve my own strategy",
                    "Compare my performance and feel discouraged",
                    "Stay focused on my own trading plan"
                ]
            },
            {
                text: "Your approach to risk management is:",
                answers: [
                    "I risk more when I'm confident about a trade",
                    "I use the same risk percentage on every trade",
                    "I adjust risk based on recent performance",
                    "I often forget to set stop losses"
                ]
            },
            {
                text: "How do you typically prepare for a trading session?",
                answers: [
                    "I jump right in when I see opportunities",
                    "I review my plan and check market conditions",
                    "I set daily profit/loss targets",
                    "I meditate or do mental preparation exercises"
                ]
            },
            {
                text: "When you're stressed during trading, you tend to:",
                answers: [
                    "Make impulsive decisions",
                    "Step away from the computer",
                    "Overtrade to relieve tension", 
                    "Stick rigidly to my rules"
                ]
            }
        ];

        var currentQuestion = 0;
        var userAnswers = [];

        function startAssessment() {
            gtag('event', 'assessment_started', {
                event_category: 'assessment',
                event_label: 'user_started_assessment'
            });

            assessmentData.startTime = new Date().toISOString();
            
            document.getElementById('intro').style.display = 'none';
            document.getElementById('question-container').classList.add('active');
            showQuestion();
        }

        function showQuestion() {
            if (currentQuestion < questions.length) {
                var question = questions[currentQuestion];
                document.getElementById('question-text').textContent = question.text;
                
                var answersContainer = document.getElementById('answers');
                answersContainer.innerHTML = '';
                
                for (var i = 0; i < question.answers.length; i++) {
                    var answerDiv = document.createElement('div');
                    answerDiv.className = 'answer';
                    answerDiv.textContent = question.answers[i];
                    answerDiv.onclick = function(index) {
                        return function() { selectAnswer(index); };
                    }(i);
                    answersContainer.appendChild(answerDiv);
                }
                
                updateProgress();

                gtag('event', 'question_viewed', {
                    event_category: 'assessment',
                    event_label: 'question_' + (currentQuestion + 1)
                });
            } else {
                showResults();
            }
        }

        function selectAnswer(answerIndex) {
            assessmentData.answers[currentQuestion] = {
                question: currentQuestion,
                answer: answerIndex,
                timestamp: new Date().toISOString()
            };

            userAnswers[currentQuestion] = answerIndex;
            
            gtag('event', 'answer_selected', {
                event_category: 'assessment',
                event_label: 'q' + (currentQuestion + 1) + '_a' + (answerIndex + 1)
            });
            
            currentQuestion++;
            setTimeout(showQuestion, 300);
        }

        function updateProgress() {
            var progress = (currentQuestion / questions.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
        }

        function showResults() {
            assessmentData.endTime = new Date().toISOString();
            assessmentData.completed = true;

            // Calculate score
            var totalScore = 0;
            for (var i = 0; i < userAnswers.length; i++) {
                totalScore += (userAnswers[i] + 1) * 10;
            }
            
            assessmentData.totalScore = totalScore;
            
            // Determine category
            var category;
            if (totalScore >= 280) {
                category = 'champion_trader';
            } else if (totalScore >= 200) {
                category = 'solid_trader';
            } else if (totalScore >= 120) {
                category = 'developing_trader';
            } else {
                category = 'vulnerable_trader';
            }
            
            assessmentData.category = category;

            // Store data
            storeAssessmentData();

            document.getElementById('question-container').classList.remove('active');
            document.getElementById('results-container').classList.add('active');
            
            var scoreCircle = document.getElementById('score-circle');
            scoreCircle.textContent = totalScore;
            scoreCircle.style.background = getScoreColor(totalScore);
            
            var resultsContent = document.getElementById('results-content');
            resultsContent.innerHTML = getResultsText(category);

            gtag('event', 'assessment_completed', {
                event_category: 'assessment',
                event_label: category,
                value: totalScore
            });
        }

        function storeAssessmentData() {
            try {
                var existingData = JSON.parse(localStorage.getItem('tradingPsychologyData') || '[]');
                existingData.push(assessmentData);
                
                if (existingData.length > 50) {
                    existingData = existingData.slice(-50);
                }
                
                localStorage.setItem('tradingPsychologyData', JSON.stringify(existingData));
            } catch (error) {
                console.log('Storage not available');
            }
        }

        function getScoreColor(score) {
            if (score >= 280) return 'linear-gradient(135deg, #4CAF50 0%, #45a049 100%)';
            if (score >= 200) return 'linear-gradient(135deg, #2196F3 0%, #1976D2 100%)';
            if (score >= 120) return 'linear-gradient(135deg, #FF9800 0%, #F57C00 100%)';
            return 'linear-gradient(135deg, #f44336 0%, #d32f2f 100%)';
        }

        function getResultsText(category) {
            var texts = {
                champion_trader: '<h3>Champion Trader üèÜ</h3><p>You demonstrate excellent emotional control and disciplined trading psychology. You have strong risk management skills and maintain composure under pressure.</p>',
                solid_trader: '<h3>Solid Trader üí™</h3><p>You have good trading psychology fundamentals with some areas for improvement. You generally maintain discipline but may struggle in high-stress situations.</p>',
                developing_trader: '<h3>Developing Trader üìà</h3><p>You show promise but need to work on emotional control and discipline. Focus on developing consistent risk management and stress management techniques.</p>',
                vulnerable_trader: '<h3>Vulnerable Trader ‚ö†Ô∏è</h3><p>Your emotions significantly impact your trading decisions. Consider taking a break to focus on psychology training and developing a solid trading plan before risking more capital.</p>'
            };
            return texts[category];
        }

        function submitEmail() {
            var email = document.getElementById('email-input').value;
            if (email && email.includes('@')) {
                assessmentData.emailProvided = true;
                storeAssessmentData();

                gtag('event', 'email_signup', {
                    event_category: 'conversion',
                    event_label: 'email_captured'
                });

                alert('Thank you! Your personalized insights will be sent to your email. PDF report is generating...');
                
                // Simple PDF generation
                generatePDF();
            } else {
                alert('Please enter a valid email address.');
            }
        }

        function generatePDF() {
            try {
                var jsPDF = window.jspdf.jsPDF;
                var doc = new jsPDF();
                
                // Header
                doc.setFillColor(102, 126, 234);
                doc.rect(0, 0, 210, 40, 'F');
                
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(11);
                doc.text("SCHNITZLEIN CONSULTING", 150, 12);
                doc.setFontSize(20);
                doc.text("Trading Psychology Report", 20, 25);
                
                // Content
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(14);
                doc.text("Your Assessment Results", 20, 60);
                doc.setFontSize(12);
                doc.text("Overall Score: " + assessmentData.totalScore + "/320", 20, 75);
                doc.text("Category: " + assessmentData.category.replace('_', ' ').toUpperCase(), 20, 85);
                
                doc.text("This is your personalized trading psychology report.", 20, 110);
                doc.text("Based on your assessment, we recommend focusing on", 20, 120);
                doc.text("emotional discipline and risk management.", 20, 130);
                
                // Footer
                doc.setFontSize(8);
                doc.setTextColor(128, 128, 128);
                doc.text("¬© 2025 Schnitzlein Consulting - Trading Psychology Assessment", 20, 280);
                
                // Download
                doc.save("Trading_Psychology_Report_" + Date.now() + ".pdf");
                
                assessmentData.pdfDownloaded = true;
                storeAssessmentData();
                
                gtag('event', 'pdf_download', {
                    event_category: 'conversion',
                    event_label: 'report_downloaded'
                });
                
            } catch (error) {
                console.error('PDF generation failed:', error);
                alert('PDF generation failed, but your results have been saved.');
            }
        }

        // Admin functions
        window.exportAssessmentData = function() {
            try {
                var data = localStorage.getItem('tradingPsychologyData');
                console.log('Trading Psychology Data:', JSON.parse(data || '[]'));
                return JSON.parse(data || '[]');
            } catch (error) {
                console.log('No data available');
                return [];
            }
        };

        window.clearAllData = function() {
            localStorage.removeItem('tradingPsychologyData');
            console.log('All data cleared');
        };
    </script>
</body>
</html>
